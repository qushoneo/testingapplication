# API Документация

## Обзор

Данное API предоставляет полный функционал для управления тестами в приложении тестирования. API использует JSON для обмена данными и JWT токены для аутентификации.

## Аутентификация

API использует JWT токены, которые передаются через HTTP-only cookies. После успешной авторизации или регистрации, токен автоматически устанавливается в cookie и используется для всех последующих запросов.

### Основные эндпоинты аутентификации:

- `POST /api/signup` - Регистрация нового пользователя
- `POST /api/login` - Авторизация пользователя
- `POST /api/logout` - Выход из системы

## Swagger UI

Интерактивная документация доступна по адресу: `/api-docs`

Swagger UI предоставляет возможность:

- Просматривать все доступные эндпоинты
- Тестировать API запросы прямо в браузере
- Изучать схемы данных и примеры запросов/ответов

## Основные модули API

### 1. Аутентификация (Authentication)

- Регистрация и авторизация пользователей
- Управление сессиями
- Восстановление пароля

### 2. Проекты (Projects)

- Создание, просмотр и удаление проектов
- Управление участниками проектов

### 3. Тест-кейсы (Test Cases)

- Создание и редактирование тест-кейсов
- Организация тест-кейсов по папкам
- Управление серьезностью (severity)

### 4. Тест-раны (Test Runs)

- Создание и управление тест-ранами
- Выполнение тестов
- Отслеживание статусов выполнения

### 4.1. Выполнение тест-кейсов (Test Case Runs)

- Обновление статуса выполнения отдельных тест-кейсов в рамках тест-рана
- Отслеживание прогресса выполнения тестов

### 5. Пользователи (Users)

- Управление пользователями компании
- Приглашения новых пользователей

### 6. Баг-репорты (Bug Reports)

- Создание баг-репортов с прикреплением скриншотов
- Просмотр всех отправленных багов

### 7. Уведомления (Notifications)

- Система уведомлений в реальном времени
- Отметка уведомлений как прочитанных

## Формат ответов

### Успешные ответы

API возвращает данные в JSON формате. Статус коды 200-299 указывают на успешную операцию.

### Ошибки валидации

```json
[
  {
    "field": "email",
    "message": "Invalid email format"
  }
]
```

### Ошибки сервера

```json
{
  "error": "Internal Server Error",
  "message": "Detailed error description"
}
```

## WebSocket интеграция

API интегрирован с WebSocket сервером для уведомлений в реальном времени:

- Уведомления о создании/удалении проектов
- Обновления для участников команды
- Система push-уведомлений

## Загрузка файлов

Система поддерживает загрузку скриншотов для баг-репортов через Supabase Storage. Изображения передаются в формате base64.

## Безопасность

- Все эндпоинты (кроме публичных) требуют аутентификации
- Пароли хешируются с использованием bcrypt
- JWT токены имеют ограниченное время жизни (30 дней)
- CORS настроен для безопасности

## Примеры использования

### Создание нового проекта

```bash
curl -X POST /api/projects \
  -H "Content-Type: application/json" \
  -d '{"name": "Мой проект"}' \
  --cookie "token=your-jwt-token"
```

### Создание тест-кейса

```bash
curl -X POST /api/projects/1/test_cases \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Тест авторизации",
    "description": "Проверка входа в систему",
    "severity": "HIGH",
    "folderId": 1
  }' \
  --cookie "token=your-jwt-token"
```

### Обновление статуса выполнения тест-кейса

```bash
curl -X PATCH /api/projects/1/test_runs/test_case_run/123 \
  -H "Content-Type: application/json" \
  -d '{
    "status": "passed"
  }' \
  --cookie "token=your-jwt-token"
```

## Поддержка

Для получения поддержки или сообщения о проблемах обращайтесь по адресу: support@testingapp.com
